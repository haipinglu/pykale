Machine learning functions for joint representation learning and prediction